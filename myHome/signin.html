<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입</title>
    <style>
      /* COMMON */
body {
  background-image: url(./images/00.jpeg);
    position: relative;
    width: 100%;
    height: 100vh;
    min-height: 850px;
    color: #333;
    font-size: 15px;
  }
  
  button {
    background-color: #344CB7;
    color: white;
    cursor: pointer;
    border: none;
    box-sizing: border-box;
  }
  
  button:hover {
    outline: 0px solid;
    background-color: #577BC1;
  }
  
  .info {
    margin-bottom: 22px;
  }
  
  .box {
    width: 100%;
    height: 50px;
    box-sizing: border-box;
    padding: 5px 0 5px 15px;
    border-radius: 4px;
    border: 1px solid #577BC1;
  }
 
  .info .error-msg {
    position: absolute;
    font-size: 11px;
    color:red;
    margin: 4px 0 0 10px;
  }
  
  select.box {
    margin-left: 5px;
    padding-left: 10px;
    background-color: white;
  }
  
  option {
    font-size: 16px;
  }
  
  .container {
    position: absolute;
    display: flex;
    flex-direction: column;
    width: 450px;
    height: 800px;
    min-width: 450px;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    margin: auto;
    justify-content: center;
    align-items: center;
    box-sizing: border-box;
  }

  .container:hover {
    background: linear-gradient(124.47deg, 
              rgba(255, 255, 255, 0.2), 
              rgba(255, 255, 255, 0.0), 
              rgba(255, 255, 255, 0.2));
    border-radius: 16px;
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(5px);
  }
  
  .content {
    width: 80%;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  
  header  {
    width: 100%;
    padding: 10px 50px;
    color: white;
    font-size: 20px;
  }
  
  header h2 {
    display: inline;
    font-size: 25px;
    font-weight: 700;
    margin-bottom: 3px;
  }
  
  form {
    margin: 50px 0 25px 0;
  }
  
  .info#info__id #id-input {
    position: relative;
  }
  
  .info#info__id button {
    position: absolute;
    width: 90px;
    height: 40px;
    top: 0;
    bottom: 0;
    right: 5px;
    margin: auto 0;
    border-radius: 3px;
    font-size: 14px;
  }
  
  .info#info__email {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
  }
  
  .info#info__email input {
    width: 90%;
  }
  
  .info#info__email span {
    font-size: 14px;
    margin: 0 3px;
  }
  
  .info .box#domain-list option {
    font-size: 14px;
    background-color: white;
  }
  
  .info#info__birth #birth-flex {
    display: flex;
  }
  
  .info#info__birth select {
    margin-left : 7px;
    color: #a0a0a0;
  }
  
  .info#info__birth select:first-child {
    margin-left : 0px;
  }
  
  .info#info__birth select::-webkit-scrollbar {
    width: 10px;
  }
  
  .info#info__birth select::-webkit-scrollbar-thumb {
    background-color: #b6b6b6;
    border-radius: 3px;
  }
  
  .info#info__birth select::-webkit-scrollbar-track {
    background-color: #ebe9e9;
    border-radius: 6px;
  }
  
  button#submit {
    width: 100%;
    height: 45px;
    border-radius: 3px;;
    font-size: 15px;
  }
  
  #result-fail {
    width: 100%;
    height: 20px;
    margin-bottom: 5px;
    text-align: center;
    color:red;
    font-size: 13px;
  }
  
  .exist {
    font-size: 13px;
    margin-top: 10px;
  }
  
  .exist a {
    margin-left: 3px;
    text-decoration: none;
    font-weight: 700;
    color:white;
    transition: .1s;
  }
  
  .exist a:hover {
    text-decoration: none;
    color:white;
  }
    </style>
  
  
</head>
<body>
  <div class="container">
    <div class="content">
      <header>
        <h2>회원가입</h2>
      </header>
      
      <form method="post" action="">
        <!--아이디-->
        <div class="info" id="info__id">
          <div id="id-input">
            <input class="box" type="text" placeholder="아이디 입력(6~20자)"/>
            <button id="id-check">중복 확인</button>
          <div class="error-msg"></div>
          </div>
        </div>
        <!--비밀번호-->
        <div class="info" id="info__pw">
          <input class="box" type="password" placeholder="비밀번호 입력 (문자, 숫자, 특수문자 포함 8~20자)"/>
          <div class="error-msg"></div>
        </div>
        <!--비밀번호 확인-->
        <div class="info" id="info__pwRe">
          <input class="box" type="password" placeholder="비밀번호 재입력"/>
          <div class="error-msg"></div>
        </div>
        <!--이메일-->
        <div class="info" id="info__email">
          <input class="box" id="email-txt" type="text" placeholder="이메일 입력"/>
          <span>@</span>
          <input class="box" id="domain-txt" type="text"/>
          <select class="box" id="domain-list">
            <option value="type">직접 입력</option>
            <option value="naver.com">naver.com</option>
            <option value="google.com">google.com</option>
            <option value="hanmail.net">hanmail.net</option>
            <option value="nate.com">nate.com</option>
            <option value="kakao.com">kakao.com</option>
          </select>
        </div>
        <!--생년월일-->
        <div class="info" id="info__birth">
          <div id="birth-flex">
            <select class="box" id="birth-year">
              <option disabled selected>출생 연도</option>
            </select>
            <select class="box" id="birth-month">
              <option disabled selected>월</option>
            </select>
            <select class="box" id="birth-day">
              <option disabled selected>일</option>
            </select>
          </div>
          <div class="error-msg"></div>
        </div>
        <!--연락처-->
        <div class="info" id="info__mobile">
          <input class="box" type="text" placeholder="휴대폰 번호 입력 (‘-’ 제외 11자리 입력)"/>
          <div class="error-msg"></div>
        </div>
    </form>

      <div id="result-fail"></div>
      <!--회원가입 버튼-->
      <button id="submit">가입하기</button>
      <!--로그인 창으로 이동-->
      <div class="exist">
        <a href="login.html">로그인 하러가기</a>
      </div>
    </div>
  </div>
  <script>
    // 에러 메세지 객체
const errMsg = {
    id: { 
      invalid: "6~20자의 영문 소문자와 숫자만 사용 가능합니다",
      success: "사용 가능한 아이디입니다",
      fail: "사용할 수 없는 아이디입니다"
    },
    pw: "8~20자의 영문, 숫자, 특수문자를 모두 포함한 비밀번호를 입력해주세요",
    pwRe: {
      success: "비밀번호가 일치합니다",
      fail: "비밀번호가 일치하지 않습니다"
    },
    birth: "생년월일을 다시 확인해주세요",
    mobile: "‘-’ 제외 11자리를 입력해주세요" 
  }
  
  // 계정 정보 객체
  const account = {
    id: null,
    pw: null,
    email: null,
    birth: null,
    mobile: null
  }
  
  /*** SECTION - ID ***/
  const idInputEl = document.querySelector('#info__id input')
  const idErrorMsgEl = document.querySelector('#info__id .error-msg')
  const idCheckBtn = document.querySelector('#id-check')
  idInputEl.addEventListener('change', () => {
    const idRegExp = /^[a-zA-Z0-9]{6,20}$/
    if(idRegExp.test(idInputEl.value)) { // 정규식 조건 만족 O
      idErrorMsgEl.textContent = ""
      account.id = idInputEl.value
    } else { // 정규식 조건 만족 X
      idErrorMsgEl.style.color = "red"
      idErrorMsgEl.textContent = errMsg.id.invalid
      account.id = null
    }
    console.log(account)
  });
  
  /*** SECTION - PASSWORD ***/
  // pwVal: 패스워드, pwReVal: 패스워드 재입력, isPwValid: 패스워드 유효 여부
  let pwVal = "", pwReVal = "", isPwValid = false
  // 비밀번호와 재입력 값 일치 여부
  function checkPwValid() {
    account.pw = null
    if(pwReVal === "") { // 미입력
      pwReErrorMsgEl.textContent = ""
    }
    else if(pwVal === pwReVal) { // 비밀번호 재입력 일치
      if(isPwValid)
        account.pw = pwVal
      pwReErrorMsgEl.style.color = "green"
      pwReErrorMsgEl.textContent = errMsg.pwRe.success
    }
    else { // 비밀번호 재입력 불일치
      pwReErrorMsgEl.style.color = "red"
      pwReErrorMsgEl.textContent = errMsg.pwRe.fail
    }
  }
  
  const pwInputEl = document.querySelector('#info__pw input')
  const pwErrorMsgEl = document.querySelector('#info__pw .error-msg')
  pwInputEl.addEventListener('change', () => {
    const pwRegExp = /^(?=.*[A-Za-z])(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{8,20}$/
    pwVal = pwInputEl.value
    if(pwRegExp.test(pwVal)) { // 유효성 검사 성공
      isPwValid = true
      pwErrorMsgEl.textContent = ""
    } 
    else { // 유효성 검사 실패
      isPwValid = false
      pwErrorMsgEl.textContent = errMsg.pw
    }
    checkPwValid()
    console.log(pwVal, pwReVal, isPwValid, account)
  });
  
  /*** SECTION - PASSWORD RECHECK ***/
  const pwReInputEl = document.querySelector('#info__pwRe input')
  const pwReErrorMsgEl = document.querySelector('#info__pwRe .error-msg')
  pwReInputEl.addEventListener('change', () => {
    pwReVal = pwReInputEl.value
    checkPwValid()
    console.log(pwVal, pwReVal, isPwValid, account)
  });
  
  /*** SECTION - EMAIL ***/
  emailList = ["", ""]
  function checkEmailValid() {
    if(emailList[0] !== "" && emailList[1] !== "") {
      account.email = emailList.join('@')
    }
    else
    account.email = null
  }
  
  const emailInputEl = document.querySelector('#email-txt')
  emailInputEl.addEventListener('change', () => {
    emailList[0] = emailInputEl.value
    checkEmailValid()
    console.log(account, emailList)
  })
  
  const domainInputEl = document.querySelector('#domain-txt')
  domainInputEl.addEventListener('change', () => {
    emailList[1] = domainInputEl.value
    checkEmailValid()
    console.log(account, emailList)
  })
  
  // 도메인 직접 입력 or domain option 선택
  const domainListEl = document.querySelector('#domain-list')
  domainListEl.addEventListener('change', () => {
    // option에 있는 도메인 선택 시
    const domainSelected = domainListEl.value
    if(domainSelected !== "type") {
      // 선택한 도메인을 input에 입력하고 disabled
      domainInputEl.value = domainSelected
      domainInputEl.disabled = true
      emailList[1] = domainSelected
    } else { // 직접 입력
      // input 내용 초기화 & 입력 가능하도록 변경
      domainInputEl.value = ""
      domainInputEl.disabled = false
      emailList[1] = ""
    }
    checkEmailValid()
    console.log(account, emailList)
  })
  
  
  /*** SECTION - BIRTH ***/
  const birthArr = [-1, -1, -1]
  /* 유효한 날짜인지 여부 확인 (윤년/평년) */
  function checkBirthValid(birthArr) {
    isBirthValid = true
    y = birthArr[0]
    m = birthArr[1]
    d = birthArr[2]
    // 생년월일 모두 선택 완료 시
    if(y > 0 && m > 0 && d > 0) {
      if ((m == 4 || m == 6 || m == 9 || m == 11) && d == 31) { 
        isBirthValid = false
      }
      else if (m == 2) {
        if(((y % 4 == 0) && (y % 100 != 0)) || (y % 400 == 0)) { // 윤년
          if(d > 29) { // 윤년은 29일까지
            isBirthValid = false
          }
        } else { // 평년
          if(d > 28) { // 평년은 28일까지
            isBirthValid = false
          }
        }
      }
  
      if(isBirthValid) { // 유효한 날짜
        birthErrorMsgEl.textContent = ""
        account.birth = birthArr.join('')
      } else { // 유효하지 않은 날짜
        birthErrorMsgEl.textContent = "생년월일을 다시 확인해주세요"
        account.birth = null
      }
    }
  }
  
  const birthErrorMsgEl = document.querySelector('#info__birth .error-msg')
  // '출생 연도' 셀렉트 박스 option 목록 동적 생성
  const birthYearEl = document.querySelector('#birth-year')
  // option 목록 생성 여부 확인
  isYearOptionExisted = false;
  birthYearEl.addEventListener('focus', function () {
    // year 목록 생성되지 않았을 때 (최초 클릭 시)
    if(!isYearOptionExisted) {
      isYearOptionExisted = true
      for(var i = 1940; i <= 2022; i++) {
        // option element 생성
        const yearOption = document.createElement('option')
        yearOption.setAttribute('value', i)
        yearOption.innerText = i
        // birthYearEl의 자식 요소로 추가
        this.appendChild(yearOption);
      }
    }
  });
  
  birthYearEl.addEventListener('change', () => {
    birthArr[0] = birthYearEl.value
    birthYearEl.style.color = "#383838"
    checkBirthValid(birthArr)
    console.log(account, birthArr)
  });
  
  // 월 select box
  const birthMonthEl = document.querySelector('#birth-month')
  isMonthOptionExisted = false;
  birthMonthEl.addEventListener('focus', function () {
    if(!isMonthOptionExisted) {
      isMonthOptionExisted = true
      for(var i = 1; i <= 12; i++) {
        const monthOption = document.createElement('option')
        if(i < 10)
          monthOption.setAttribute('value', '0' + i)
        else
          monthOption.setAttribute('value', i)
        monthOption.innerText = i
        this.appendChild(monthOption);
      }
    }
  });
  
  birthMonthEl.addEventListener('change', () => {
    birthArr[1] = birthMonthEl.value
    birthMonthEl.style.color = "#383838"
    checkBirthValid(birthArr)
    console.log(account, birthArr)
  });
  
  // 일 select box
  const birthDayEl = document.querySelector('#birth-day')
  isDayOptionExisted = false;
  birthDayEl.addEventListener('focus', function () {
    if(!isDayOptionExisted) {
      isDayOptionExisted = true
      for(var i = 1; i <= 31; i++) {
        const dayOption = document.createElement('option')
        if(i < 10)
          dayOption.setAttribute('value', '0' + i)
        else
          dayOption.setAttribute('value', i)
        dayOption.innerText = i
        this.appendChild(dayOption);
      }
    }
  });
  
  birthDayEl.addEventListener('change', () => {
    birthArr[2] = birthDayEl.value
    birthDayEl.style.color = "#383838"
    checkBirthValid(birthArr)
    console.log(account, birthArr)
  });
  
  /*** SECTION - MOBILE ***/
  const mobileInputEl = document.querySelector('#info__mobile input')
  const mobileErrorMsgEl = document.querySelector('#info__mobile .error-msg')
  mobileInputEl.addEventListener('change', () => {
    const mobileRegExp = /^010([0-9]{8})$/
    if(mobileRegExp.test(mobileInputEl.value)) { // 유효성 검사 성공
      account.mobile = mobileInputEl.value
      mobileErrorMsgEl.textContent = ""
    } else { // 유효성 검사 실패
      account.mobile = null
      mobileErrorMsgEl.textContent = errMsg.mobile
    }
    console.log(account)
  });
  
  /*** SUBMIT ***/
  const submitBtn = document.querySelector('#submit')
  const resultFailEl = document.querySelector('#result-fail')
  submitBtn.addEventListener('click', function() {
    let isAllFilled = true
    const word = {  
      id: "아이디를",
      pw: "비밀번호를",
      email: "이메일을",
      birth: "생년월일을",
      mobile: "휴대폰 번호를"
    }
    for(element in account) {
      if(account[element] === null) {
        resultFailEl.textContent = word[element] + " 다시 한번 확인해주세요"
        isAllFilled = false
        break
      }
    }
    if (isAllFilled === true) {
      resultFailEl.textContent = ""
      setTimeout(function() {
        alert("회원가입 완료")
      }, 300)
     
    }
  })
  </script>
</body>
</html>